<!doctype html><html>  <head>    <meta charset="utf-8">    <base href="../">    <title>JSDoc: source : tableSort.js</title>    <link href="css/prettify-tomorrow.css" type="text/css" rel="stylesheet">    <link href="css/site.css" type="text/css" rel="stylesheet">  </head>  <body ng-app="">    <nav id="toc">      <input placeholder="Filter" id="filter-input" class="col12 block field" type="text">      <div class="nav-wrapper">      <h2><a href="index.html">Index</a></h2>      <ul class="module">        <!-- undefined -->        <h2 class="module">          <a chref="" ng-click="moduleundefined = !moduleundefined">            module: undefined          </a>          <i ng-cloak="" ng-show="moduleundefined">+</i>        </h2>        <li id="undefined" ng-hide="moduleundefined">          <ul class="group">            <h2>              <a href="" ng-click="undefineddirective = !undefineddirective">                directive              </a>              <i ng-cloak="" ng-show="undefineddirective">+</i>            </h2>            <ul ng-hide="undefineddirective">              <li>                <a href="tableSort.html">tableSort</a>              </li><li>                <a href="tableSortField.html">tableSortField</a>              </li>            </ul>          </ul><ul class="group">            <h2>              <a href="" ng-click="undefinedcontroller = !undefinedcontroller">                controller              </a>              <i ng-cloak="" ng-show="undefinedcontroller">+</i>            </h2>            <ul ng-hide="undefinedcontroller">              <li>                <a href="TableSortController.html">TableSortController</a>              </li><li>                <a href="TableSortFieldController.html">TableSortFieldController</a>              </li>            </ul>          </ul>        </li>      </ul>      </div>    </nav>    <div id="content" class="page-wrap">      <h1 class="title">        source : tableSort.js      </h1>      <div id="main" class="big-container">        <!-- source code html -->        <article>          <pre class="prettyprint source linenums"><code>/**
 * Angular TableSort
 * Copyright 2016 Andreas Stocker
 * MIT License
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
 * documentation files (the "Software"), to deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the
 * Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
 * WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS
 * OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
 * OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
(function () {
    'use strict';
    var
        module = angular.module('ngTableSort');
    /**
     * Directive for client side table sorting.
     *
     * @name tableSort
     * @ngdoc directive
     */
    module.directive('tableSort',
        function () {
            return {
                restrict: 'A',
                scope: true,
                controller: 'TableSortController'
            };
        }
    );
    /**
     * Controller for client side table sorting.
     *
     * @name TableSortController
     * @ngdoc controller
     */
    module.controller('TableSortController',
        function ($scope,
                  $filter) {
            'ngInject';
            var
                self = this,
                orderBy = $filter('orderBy'),
                tableSortField = null,
                tableSortReverse = null;
            /**
             * Gets the expression to sort on.
             *
             * @memberof TableSortController
             * @return {*}
             */
            self.getTableSortField = function () {
                return tableSortField;
            };
            /**
             * Sets the expression to sort on.
             *
             * @memberof TableSortController
             * @param config
             */
            self.setTableSortField = function (config) {
                tableSortField = config;
            };
            /**
             * Gets whether to sort in reverse order or not.
             *
             * @memberof TableSortController
             * @return {boolean}
             */
            self.getTableSortReverse = function () {
                return !!tableSortReverse;
            };
            /**
             * Sets whether to sort in reverse order or not.
             *
             * @memberof TableSortController
             * @param reverse
             */
            self.setTableSortReverse = function (reverse) {
                tableSortReverse = reverse;
            };
            /**
             * Sorts the given list by the sort configuration.
             *
             * @memberof TableSortController
             * @param list
             * @return {*}
             */
            self.tableSort = function (list) {
                var
                    field = self.getTableSortField(),
                    reverse = self.getTableSortReverse();
                // Only sort when we have a field to sort on
                if (field) {
                    // Publish the scope on each item
                    for (var i = 0; i &lt; list.length; i++) {
                        list[i].$$scope = $scope;
                        list[i].$$this = list[i];
                    }
                    list = orderBy(list, field, reverse);
                    // Remove the scope from each item
                    for (var j = 0; j &lt; list.length; j++) {
                        delete list[j].$$scope;
                        delete list[j].$$this;
                    }
                }
                return list;
            };
            /*
             * Publish the API on the scope
             */
            $scope.getTableSortField = self.getTableSortField;
            $scope.setTableSortField = self.setTableSortField;
            $scope.getTableSortReverse = self.getTableSortReverse;
            $scope.setTableSortReverse = self.setTableSortReverse;
            $scope.tableSort = self.tableSort;
        }
    );
    /**
     * Directive for client side table sorting on a specific field.
     *
     * @name tableSortField
     * @ngdoc directive
     */
    module.directive('tableSortField',
        function () {
            return {
                require: '^tableSort',
                restrict: 'A',
                scope: true,
                controller: 'TableSortFieldController',
                link: function (scope, element, attrs, tableSortCtrl) {
                    scope.tableSortCtrl = tableSortCtrl;
                    scope.tableSortField = attrs.tableSortField;
                    scope.tableSortInitial = !angular.isUndefined(attrs.tableSortInitial);
                }
            };
        }
    );
    /**
     * Controller for client side table sorting.
     *
     * @name TableSortFieldController
     * @ngdoc controller
     */
    module.controller('TableSortFieldController',
        function ($scope) {
            'ngInject';
            var
                self = this,
                reverse = false;
            // Set the constructor
            self.$onInit = init;
            /**
             * Calls the sort operation on the table sort directive.
             *
             * @memberof TableSortFieldController
             */
            self.tableSort = function () {
                var
                    currentField = $scope.tableSortCtrl.getTableSortField(),
                    selfField = $scope.tableSortField;
                // Toggle reverse if we are already sorting on this field, else
                // do not reverse
                reverse = currentField === selfField ? !reverse : false;
                $scope.tableSortCtrl.setTableSortField(selfField);
                $scope.tableSortCtrl.setTableSortReverse(reverse);
            };
            /**
             * Checks if this is the field we are currently sorting on.
             *
             * @memberof TableSortFieldController
             * @return {boolean}
             */
            self.current = function () {
                var
                    currentField = $scope.tableSortCtrl.getTableSortField(),
                    selfField = $scope.tableSortField;
                return currentField === selfField;
            };
            /**
             * Checks if we are sorting on reverse order.
             *
             * @memberof TableSortFieldController
             * @return {boolean}
             */
            self.reverse = function () {
                return !!reverse;
            };
            /*
             * Publish the API on the scope
             */
            $scope.tableSort = self.tableSort;
            $scope.current = self.current;
            $scope.reverse = self.reverse;
            /**
             * Initializes the initial sorting on the field.
             *
             * @memberof TableSortFieldController
             * @private
             */
            function initInitial () {
                var
                    unwatch = $scope.$watch(
                        function watcher () {
                            return $scope.tableSortField;
                        },
                        function callback (tableSortField) {
                            // Do nothing if we do not have the value yet
                            if (!tableSortField) {
                                return;
                            }
                            // De-register the watcher
                            unwatch();
                            // Sort if this field is configured as initial sort field and there is
                            // no sort configuration yet
                            if ($scope.tableSortInitial && !$scope.tableSortCtrl.getTableSortField()) {
                                console.log("TableSortFieldController: Initial sort on expression '" + tableSortField + "'.");
                                $scope.tableSort();
                            }
                        }
                    )
            }
            /**
             * Initializes the directive.
             *
             * @memberof TableSortFieldController
             * @private
             */
            function init () {
                initInitial();
            }
        }
    );
})();
</code></pre>        </article>        <!-- index.html -->        <!-- class files -->      </div>      <footer style="clear:both">        Documentation generated by        <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.2</a>        using        <a href="https://github.com/allenhwkim/angular-jsdoc">Angular-JSDoc template</a>      </footer>    </div>    <script src="js/prettify.js"></script>    <script src="js/angular.min.js"></script>    <script src="js/site.js"></script>    <!--%= prettyJson %-->    <script>      prettyPrint();      var lineNo = window.location.hash.match(/#line([0-9]+)$/);      lineNo && document.querySelector("ol li:nth-child("+(lineNo[1])+")").scrollIntoView();    </script>  </body></html>